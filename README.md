# testing_satping

## Диагностика узкополосного приёма SX1262

В прошивке добавлена функция `configureNarrowbandRxOptions()`, которая автоматически подтягивает критичные настройки для полосы 7.81 кГц и близких значений:

- переводит радиомодуль в непрерывный `SetRx` (timeout = 0) для тестов без окон, либо держит окно не менее 2.15 с, если нужно ограничение;
- включает остановку RX-таймера по преамбуле (`SetStopRxTimerOnPreamble(true)`), чтобы окно не закрывалось посреди пакета;
- увеличивает преамбулу до 16–24 символов, давая запас на CAD→RX и прогрев TCXO;
- принудительно активирует LDRO, когда длительность символа превышает 16 мс;
- расширяет `LoRaSymbNumTimeout`, чтобы поиск заголовка покрывал преамбулу;
- ведёт журнал таймингов с префиксом `[RX t=…]`, фиксируя команды `SetRx`, `PreambleDetected`, `SyncWordValid`, `HeaderValid`, `RxDone` и задержку относительно последнего `SetRx`.

По умолчанию диагностика держит флаг `state.rxTiming.forceContinuousRx = true`. Для боевого режима его можно отключить в коде, чтобы вернуть оконный приём.

Журналы доступны в веб-интерфейсе и по `GET /api/log`.
